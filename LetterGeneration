from docx import Document

def generate_test_result_letter(student_data):
    # Load the template document
    doc = Document('path_to_template.docx')

    # Replace placeholders with actual data
    for paragraph in doc.paragraph

    for paragraph in doc.paragraphs:
        # Replace each placeholder in the paragraph with the corresponding data
        if 'STUDENT_NAME' in paragraph.text:
            paragraph.text = paragraph.text.replace('STUDENT_NAME', student_data['name'])
        if 'TEST_DATE' in paragraph.text:
            paragraph.text = paragraph.text.replace('TEST_DATE', student_data['test_date'])
        # ... (continue for other placeholders)

    # Handling the table for detailed test results
    table = doc.tables[0]  # Assuming the table for test results is the first one in the document
    for i, row in enumerate(table.rows):
        if i == 0:
            continue  # Skip header row
        # Assuming columns for 'Objective', 'Correct Answer', 'Student Answer'
        row.cells[0].text = student_data['results'][i-1]['objective']
        row.cells[1].text = student_data['results'][i-1]['correct_answer']
        row.cells[2].text = student_data['results'][i-1]['student_answer']

    # Save the document
    doc.save(f'result_letter_for_{student_data["name"]}.docx')

# Example usage
student_data = {
    'name': 'John Doe',
    'test_date': '2024-01-16',
    'results': [
        {'objective': 'Math Basics', 'correct_answer': 'A', 'student_answer': 'B'},
        # ... (more test results)
    ]
}
generate_test_result_letter(student_data)
